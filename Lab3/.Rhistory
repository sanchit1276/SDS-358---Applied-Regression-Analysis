setwd("~/Graduate School/UT-Austin - MSIS/SDS 358 - Applied Regression Analysis/Lab3")
#### Here is the R script you will use:  (remember that # indicates a comment) ####
##Lab 3: Simple Regression, Inference
library(SDSRegressionR)
library(tidyverse)
intel <- read_csv("data/intelligence.csv")
View(intel)
View(intel)
#Scale MRI to something OK....
fivenum(intel$MRIcount)
intel <- intel %>%
mutate(mri_100 = MRIcount / 100000)
#Define variables that might be of interest
vars <- c("PIQ", "mri_100", "Weight", "Height")
#New way to get basic descriptives:
library(psych)
describe(select(intel, one_of(vars)), IQR = TRUE)
#Take an intial look at the variables (including PIQ and MRI)
library(psych)
corr.test(select(intel, one_of(vars)))$r
#Check linearity
simpleScatter(intel, mri_100, PIQ, line=TRUE)
#Run the intial model
iq <- lm(PIQ ~ mri_100, data=intel)
summary(iq)
#Look for outliers
threeOuts(iq, key.variable = "SubjectID")
cooksPlot(iq, key.variable = "SubjectID", print.obs = TRUE)
#Remove the offending outlier
intel_noout <- intel %>%
filter(SubjectID %not in% c(23))
#Re-run the model
iq2 <- lm(PIQ ~ mri_100, data=intel_noout)
summary(iq2)
#Grab confidence intervals
confint(iq2)
#Predict new MRI of 1,000,000
nw_mri <- data.frame(mri_100 = 10)
predict(iq2, nw_mri, interval="prediction")
library(car)
linearHypothesis(iq2, "mri_100 = 10.00")
install.packages("car")
library(car)
linearHypothesis(iq2, "mri_100 = 10.00")
